# Reload Path
$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")

# Run weekly. Current week: {{ div now.YearDay 7 }}, {{ now.Year }}

{{- $packages := joinPath .chezmoi.sourceDir ".data/packages.yaml" | include | fromYaml -}}
{{ range $packages -}}
{{- if hasKey . "uv-tool" }}
uv tool install --upgrade {{ get . "uv-tool" }}
if ($lastexitcode -ne 0) {
    Write-Host -ForegroundColor Red "uv tool install {{ get . "uv-tool" }} failed with exit code $lastexitcode"
    exit 1
}
{{ end -}}
{{- end -}}
